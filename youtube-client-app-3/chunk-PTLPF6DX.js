import{b as f,c as v,l as L,m as S,n as Y,r as h,s as x,u as W,v as J}from"./chunk-CMLQADZH.js";import{H as z,L as I,Na as H,O as C,Ua as M,a as n,b as m,c as dt,d as nt,e as k,g as b,ga as g,l as E,o as y,q,t as O}from"./chunk-NLXPBHEF.js";var N=dt((j,K)=>{"use strict";(function(e,r){typeof j=="object"&&typeof K<"u"?r(j):typeof define=="function"&&define.amd?define(["exports"],r):r((e=typeof globalThis<"u"?globalThis:e||self).buildUrl={})})(j,function(e){"use strict";function r(i,s,a){var d=[];for(var lt in i)(function(c){var p,A;Object.prototype.hasOwnProperty.call(i,c)&&i[c]!==void 0&&(Array.isArray(i[c])&&i[c].length?a?(A=a==="order_desc"?i[c].length-1:0,i[c].forEach(function(D){switch(p=D!==0?D||"":0,a){case"array":d.push("".concat(c,"[]=").concat(encodeURIComponent(String(p).trim())));break;case"order_asc":d.push("".concat(c,"[").concat(A++,"]=").concat(encodeURIComponent(String(p).trim())));break;case"order_desc":d.push("".concat(c,"[").concat(A--,"]=").concat(encodeURIComponent(String(p).trim())));break;default:d.push("".concat(c,"=").concat(encodeURIComponent(String(p).trim())))}})):(p=i[c].map(function(D){return encodeURIComponent(String(D!==0?D||"":0).trim())}),d.push("".concat(c,"=").concat(encodeURIComponent(String(p).trim())))):(p=s?String(i[c]).toLowerCase()||"":i[c]!==0?i[c]||"":0,d.push("".concat(c,"=").concat(encodeURIComponent(String(p).trim())))))})(lt);return"?".concat(d.join("&"))}function u(i,s,a){s===void 0&&(s=""),s[s.length-1]==="/"&&(s=s.slice(0,-1));var d=String(i).trim();return a&&(d=d.toLowerCase()),d.indexOf("/")===0?s+=d:s+="/".concat(d),s}function t(i,s){var a="#".concat(String(i).trim());return s?a.toLowerCase():a}function o(i,s){var a;return i===null?a="":typeof i=="object"?(a="",s=i):a=i,s!=null&&s.path&&(a=u(s.path,a,s.lowerCase)),s!=null&&s.queryParams&&(a+=r(s.queryParams,s.lowerCase,s.disableCSV)),s!=null&&s.hash&&(a+=t(s.hash,s.lowerCase)),a}e.appendPath=u,e.buildHash=t,e.buildQueryString=r,e.buildUrl=o,e.default=o,Object.defineProperty(e,"__esModule",{value:!0})})});var w=f("[YouTubeCard] Load YouTube Cards"),F=f("[YouTubeCard] Load YouTube Cards Success",v()),V=f("[YouTubeCard] Load YouTube Cards Failure",v()),B=f("[YouTubeCard] Clear YouTube Cards"),Q=f("[YouTubeCard] Add YouTube Card to Favorites",v()),G=f("[YouTubeCard] Remove YouTube Card from Favorites",v());var P=nt(N(),1);var X="/search";var Z="/videos";var U={detailsByVideoId(e){return(0,P.buildUrl)(Z,{queryParams:{part:"snippet,contentDetails,statistics",id:e}})??""},videosByTitle(e){return(0,P.buildUrl)(X,{queryParams:{part:"snippet",type:"video",q:e,maxResults:10}})??""}};var l=class l{constructor(r){this.http=r}getById(r){let u=U.detailsByVideoId(r);this.http.get(u).pipe(y(t=>t.items),O(t=>(l.errorSignal.set(t.message),E([])))).subscribe(t=>l.videoDetailsByIdSignal.set(t))}getByTitle(r){let u=U.videosByTitle(r);this.http.get(u).pipe(y(t=>t.items.map(o=>o.id.videoId)),z(t=>q(t.map(o=>this.http.get(U.detailsByVideoId(o)).pipe(y(i=>i.items))))),y(t=>t.flat()),O(t=>(l.errorSignal.set(t.message),E([])))).subscribe(t=>l.videoDetailsByTitleSignal.set(t))}};l.videoDetailsByIdSignal=g([]),l.videoDetailsByTitleSignal=g([]),l.errorSignal=g(null),l.\u0275fac=function(u){return new(u||l)(C(M))},l.\u0275prov=I({token:l,factory:l.\u0275fac,providedIn:"root"});var T=l;var Vt=f("[Favorite] Load YouTube Cards"),tt=f("[Favorite] Load YouTube Cards Success",v());var et={customCards:[],error:null};var rt=x(et,h(J,(e,{card:r})=>m(n({},e),{customCards:[...e.customCards,r]})),h(W,(e,{cards:r})=>m(n({},e),{customCards:r})));var st=Y({name:"customCards",reducer:rt});var $=S(st.selectCustomCards,e=>e||[]);var it={videos:{},videoListIds:[],favoriteListIds:[],favoriteVideos:[],error:null};var ot=x(it,h(w,e=>m(n({},e),{error:null})),h(F,(e,{cards:r})=>{let u=r.reduce((o,i)=>(o[i.id]=i,o),{}),t=r.map(o=>o.id);return m(n({},e),{videos:u,videoListIds:t,error:null})}),h(V,(e,{error:r})=>m(n({},e),{error:r})),h(B,e=>m(n({},e),{videos:{},videoListIds:[],favoriteListIds:[]})),h(Q,(e,{cardId:r})=>e.favoriteListIds.includes(r)?e:m(n({},e),{favoriteListIds:[...e.favoriteListIds,r]})),h(G,(e,{cardId:r})=>m(n({},e),{favoriteListIds:e.favoriteListIds.filter(u=>u!==r)})),h(tt,(e,{cards:r})=>m(n({},e),{favoriteVideos:[...r]})));var at=Y({name:"youtubeCards",reducer:ot});var ct=e=>e.youtubeCards,ht=S(ct,e=>e.videos),R=S(at.selectVideos,e=>Object.values(e)),ft=S(ct,e=>e.videoListIds),se=S(ht,ft,(e,r)=>r.map(u=>e[u]));var ut=(()=>{let r=class r{constructor(t){this.store=t,this.filterTitle=new b(""),this.filterDate=new b(""),this.filterView=new b(""),this.detalisId=new b(""),this.searchResultsData=new b({filters:{filterTitle:"",filterDate:"asc",filterViews:"",searchInputHeader:""},searchedItems$:this.store.select(R)}),this.customCardsData=new b({filters:{filterTitle:"",filterDate:"asc",filterViews:"",searchInputHeader:""},customItems$:this.store.select($)}),this.filterTitle$=this.filterTitle.asObservable(),this.filterDate$=this.filterDate.asObservable(),this.filterView$=this.filterView.asObservable(),this.searchResultsData$=this.searchResultsData.asObservable(),this.customCardsData$=this.customCardsData.asObservable(),this.detalisId$=this.detalisId.asObservable()}setFilterTitle(t){this.filterTitle.next(t)}setFilterDate(t){this.filterDate.next(t)}setFilterView(t){this.filterView.next(t)}setSearchResultsData(t){this.searchResultsData.next(t)}setCustomCardsData(t){this.customCardsData.next(t)}setDetalisId(t){this.detalisId.next(t)}};r.\u0275fac=function(o){return new(o||r)(C(L))},r.\u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var pe=(()=>{let r=class r{constructor(t,o,i){this.youtubeService=t,this.sharedService=o,this.store=i,this.customItems$=new k,this.customItems=[],this.searchedItems$=this.store.select(R),this.SearchResultsData={filters:{filterTitle:"",filterDate:"asc",filterViews:"",searchInputHeader:""},searchedItems$:this.store.select(R)},this.CustomCardsData={filters:{filterTitle:"",filterDate:"asc",filterViews:"",searchInputHeader:""},customItems$:this.store.select($)},this.subscriptions=[],this.initializeEffects()}initializeEffects(){H(()=>{let t=T.videoDetailsByTitleSignal();t.length>0&&this.store.dispatch(F({cards:t}))},{allowSignalWrites:!0}),H(()=>{let t=T.errorSignal();t&&this.store.dispatch(V({error:t}))},{allowSignalWrites:!0})}turnOnListeners(){this.sharedService.filterTitle$.subscribe(t=>{this.SearchResultsData.filters.filterTitle=t,this.CustomCardsData.filters.filterTitle=t,this.listenSearchResultsData()}),this.sharedService.filterDate$.subscribe(t=>{this.SearchResultsData.filters.filterDate=t,this.CustomCardsData.filters.filterDate=t,this.listenSearchResultsData()}),this.sharedService.filterView$.subscribe(t=>{this.SearchResultsData.filters.filterViews=t,this.CustomCardsData.filters.filterViews=t,this.listenSearchResultsData()}),this.subscriptions.push(this.sharedService.searchResultsData$.subscribe(t=>{this.SearchResultsData=t}),this.CustomCardsData.customItems$.subscribe(t=>{this.customItems=t}))}listenSearchResultsData(){this.sharedService.setSearchResultsData(this.SearchResultsData),this.sharedService.setCustomCardsData(this.CustomCardsData)}destroyListeners(){this.subscriptions.forEach(t=>t.unsubscribe())}searchByTitle(t){this.store.dispatch(w()),this.youtubeService.getByTitle(t)}clearCards(){this.store.dispatch(B())}getPublishedDate(t){return t.snippet.publishedAt}searchedItems(){this.searchByTitle(this.SearchResultsData.filters.searchInputHeader)}};r.\u0275fac=function(o){return new(o||r)(C(T),C(ut),C(L))},r.\u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();export{V as a,Q as b,G as c,T as d,rt as e,$ as f,tt as g,ot as h,ut as i,pe as j};
