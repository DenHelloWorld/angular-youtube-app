import{b as c,c as p,l as ae,m,n as y,r as n,s as F,u as le,v as ne}from"./chunk-2IE7ZCEN.js";import{$a as K,Aa as G,Ba as z,Ea as k,G as U,K as h,N as b,Na as C,O as D,Ob as se,Q as j,Ta as q,Ua as J,a,b as l,c as g,ca as w,cb as Q,eb as X,fa as u,hb as Z,ia as A,k as x,ka as T,la as S,ma as H,n as v,nb as ee,p as O,qa as R,qb as te,rb as re,s as B,sb as ie,tb as oe,va as P,ya as W,za as $}from"./chunk-IKLVSTII.js";var I=(()=>{class e{constructor(){this.isShowFilter=u(!1),this.filterData=u({filterTitle:"",filterDate:"",filterViews:""})}toggleView(){this.isShowFilter.set(!this.isShowFilter())}handleSort(r){switch(r){case"Date:Ascending":this.filterData().filterViews="",this.filterData().filterDate="asc";break;case"Date:Descending":this.filterData().filterViews="",this.filterData().filterDate="desc";break;case"Views:Ascending":this.filterData().filterDate="",this.filterData().filterViews="asc";break;case"Views:Descending":this.filterData().filterDate="",this.filterData().filterViews="desc";break;default:this.filterData().filterDate="",this.filterData().filterViews="";break}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var s={ASC:"asc",DESC:"desc",NONE:null};var we=(e,t)=>({icon:e,label:"Date",raised:t}),ye=(e,t)=>({icon:e,label:"Views",raised:t}),$e=(()=>{class e{constructor(){this.filterService=D(I),this.isShowFilter=!1,this.filterMode={date:null,views:null},C(()=>{this.isShowFilter=this.filterService.isShowFilter()})}arrow(r){return r===null?"pi pi-expand":r===s.ASC?"pi pi-angle-up":"pi pi-angle-down"}hideFilter(){this.filterService.isShowFilter.set(!1)}ngOnInit(){}sortByDate(){switch(this.filterMode.views=s.NONE,this.filterMode.date){case s.NONE:this.filterMode.date=s.ASC,this.filterService.handleSort("Date:Ascending");break;case s.ASC:this.filterMode.date=s.DESC,this.filterService.handleSort("Date:Descending");break;case s.DESC:this.filterMode.date=s.NONE,this.filterService.handleSort("Date:None");break}}sortByViews(){switch(this.filterMode.date=s.NONE,this.filterMode.views){case s.NONE:this.filterMode.views=s.ASC,this.filterService.handleSort("Views:Ascending");break;case s.ASC:this.filterMode.views=s.DESC,this.filterService.handleSort("Views:Descending");break;case s.DESC:this.filterMode.views=s.NONE,this.filterService.handleSort("Views:None");break}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=j({type:e,selectors:[["app-filter"]],standalone:!0,features:[z],decls:10,vars:9,consts:[[1,"p-toolbar-group-start","gap-2"],["type","text","pInputText","","placeholder","Filter by title",3,"ngModelChange","ngModel"],[1,"flex","gap-2","items-center"],[1,"font-medium","text-stone-500"],[3,"clickEmitter","config"],[1,"p-toolbar-group-center"],[1,"p-toolbar-group-end"]],template:function(i,o){i&1&&(T(0,"p-toolbar")(1,"div",0)(2,"input",1),G("ngModelChange",function(_){return $(o.filterService.filterData().filterTitle,_)||(o.filterService.filterData().filterTitle=_),_}),S(),T(3,"div",2)(4,"span",3),P(5,"Sort by:"),S(),T(6,"app-custom-button",4),R("clickEmitter",function(){return o.sortByDate()}),S(),T(7,"app-custom-button",4),R("clickEmitter",function(){return o.sortByViews()}),S()()(),H(8,"div",5)(9,"div",6),S()),i&2&&(w(2),W("ngModel",o.filterService.filterData().filterTitle),w(4),A("config",k(3,we,o.arrow(o.filterMode.date),!o.filterMode.date)),w(),A("config",k(6,ye,o.arrow(o.filterMode.views),!o.filterMode.views)))},dependencies:[ee,Q,X,Z,q,oe,ie,re,te,se],encapsulation:2})}}return e})();var ce="/search";var de="/videos";var Y={detailsByVideoId(e){let t=new URLSearchParams({part:"snippet,contentDetails,statistics",id:e});return`${de}?${t.toString()}`},videosByTitle(e){let t=new URLSearchParams({part:"snippet",type:"video",q:e,maxResults:"10"});return`${ce}?${t.toString()}`}};var f=class e{static{this.videoDetailsByIdSignal=u([])}static{this.videoDetailsByTitleSignal=u([])}static{this.errorSignal=u(null)}constructor(t){this.http=t}getById(t){let r=Y.detailsByVideoId(t);this.http.get(r).pipe(v(i=>i.items),B(i=>(e.errorSignal.set(i.message),x([])))).subscribe(i=>e.videoDetailsByIdSignal.set(i))}getByTitle(t){return g(this,null,function*(){let r=Y.videosByTitle(t);this.http.get(r).pipe(v(i=>i.items.map(o=>o.id.videoId)),U(i=>O(i.map(o=>this.http.get(Y.detailsByVideoId(o)).pipe(v(d=>d.items))))),v(i=>i.flat()),B(i=>(e.errorSignal.set(i.message),x([])))).subscribe(i=>e.videoDetailsByTitleSignal.set(i))})}static{this.\u0275fac=function(r){return new(r||e)(b(J))}}static{this.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})}};var E=c("[YouTubeCard] Load YouTube Cards"),L=c("[YouTubeCard] Load YouTube Cards Success",p()),M=c("[YouTubeCard] Load YouTube Cards Failure",p()),V=c("[YouTubeCard] Clear YouTube Cards"),ue=c("[YouTubeCard] Add YouTube Card to Favorites",p()),pe=c("[YouTubeCard] Remove YouTube Card from Favorites",p());var nt=c("[Favorite] Load YouTube Cards"),me=c("[Favorite] Load YouTube Cards Success",p());var fe={customCards:[],error:null};var he=F(fe,n(ne,(e,{card:t})=>l(a({},e),{customCards:[...e.customCards,t]})),n(le,(e,{cards:t})=>l(a({},e),{customCards:t})));var Se=y({name:"customCards",reducer:he});var Ce=m(Se.selectCustomCards,e=>e||[]);var ve={videos:{},videoListIds:[],favoriteListIds:[],favoriteVideos:[],error:null};var be=F(ve,n(E,e=>l(a({},e),{error:null})),n(L,(e,{cards:t})=>{let r=t.reduce((o,d)=>(o[d.id]=d,o),{}),i=t.map(o=>o.id);return l(a({},e),{videos:r,videoListIds:i,error:null})}),n(M,(e,{error:t})=>l(a({},e),{error:t})),n(V,e=>l(a({},e),{videos:{},videoListIds:[],favoriteListIds:[]})),n(ue,(e,{cardId:t})=>e.favoriteListIds.includes(t)?e:l(a({},e),{favoriteListIds:[...e.favoriteListIds,t]})),n(pe,(e,{cardId:t})=>l(a({},e),{favoriteListIds:e.favoriteListIds.filter(r=>r!==t)})),n(me,(e,{cards:t})=>l(a({},e),{favoriteVideos:[...t]})));var De=y({name:"youtubeCards",reducer:be});var Te=e=>e.youtubeCards,Ie=m(Te,e=>e.videos),ge=m(De.selectVideos,e=>Object.values(e)),Ye=m(Te,e=>e.videoListIds),Bt=m(Ie,Ye,(e,t)=>t.map(r=>e[r]));var $t=(()=>{class e{constructor(r,i){this.youtubeService=r,this.store=i,this.router=D(K),this.filterService=D(I),this.customItems=[],this.SearchResultsData={filters:{filterTitle:"",filterDate:"",filterViews:""},searchInputHeader:"",searchedItems$:this.store.select(ge)},this.CustomCardsData={filters:{filterTitle:"",filterDate:"",filterViews:""},searchInputHeader:"",customItems$:this.store.select(Ce)},this.initializeEffects()}initializeEffects(){C(()=>{let r=f.videoDetailsByTitleSignal();r.length>0&&this.store.dispatch(L({cards:r}))},{allowSignalWrites:!0}),C(()=>{let r=f.errorSignal();r&&this.store.dispatch(M({error:r}))},{allowSignalWrites:!0}),C(()=>{this.SearchResultsData.filters=this.filterService.filterData()})}searchByTitle(r){return g(this,null,function*(){this.store.dispatch(E()),yield this.youtubeService.getByTitle(r),this.router.navigate(["/main"])})}clearCards(){this.store.dispatch(V())}getPublishedDate(r){return r.snippet.publishedAt}searchedItems(){this.searchByTitle(this.SearchResultsData.searchInputHeader)}static{this.\u0275fac=function(i){return new(i||e)(b(f),b(ae))}}static{this.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{f as a,M as b,ue as c,pe as d,me as e,he as f,Ce as g,be as h,I as i,$t as j,$e as k};
